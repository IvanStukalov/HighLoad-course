# ВКонтакте

---

## Тема и целевая аудитория

### Тема

**ВКонтакте** - социальная сеть, предназначенная для обмена сообщениями между пользователями.
Кроме того имеет такой функционал, как добавление в друзья, формирование и просмотр ленты.

### MVP

* Регистрация и авторизация пользователей
* Профиль пользователя
* Поиск людей
* Добавление в друзья
* Обмен сообщениями (создание, редактирование, удаление) в личной беседе
* Просмотр ленты (лента формируется из постов, созданных друзьями пользователя)

### Целевая аудитория

* Международная месячная аудитория 101,7 млн пользователей
* Дневная аудитория 53,6 пользователей
* 15 млрд сообщений в день

#### Распределение пользователей по странам:

| Страна    | %     | чел, млн |
|-----------|-------|----------|
| Россия    | 83,59 | 85,01    |
| Беларусь  | 3,13  | 3,18     |
| Казахстан | 2,30  | 2,34     |
| Украина   | 1,26  | 1,28     | 
| Германия  | 0,96  | 0,98     |
| Другое    | 8,76  | 8,91     |

---

## Расчет нагрузки

### Продуктовые метрики

* Месячная аудитория 101,7 млн
* Дневная аудитория 53,6 млн
* 15 млрд сообщений в день

#### Усредненные метрики

1. Регистрация:

```
Аудитория ВКонтакте растет в среднем на 32% каждый год
   
Аудитория в 2023 году - 101,7 млн, в 2022 на 32% меньше, ~77 млн
   
Прирост аудитории за год - 25 млн
   
RPS: 25*10^6 / (365 * 24 * 60 * 60) = 0,8 
```

2. Авторизация:

```
Дневная аудитория ВК: 53,6 млн
   
Обычно пользователь авторизуется раз в 3 месяца, получает куку и далее использует её.
Тогда получается, что пользователь авторизуется 4 раза в год.
   
RPS: 53,6*10^6 * 4 / (365 * 24 * 60 * 60) = 6,8
```

3. Создание сообщения:

```
В день сообщений: 15 млрд
   
RPS: 15*10^9 / (24 * 60 * 60) = 174 тыс
```

4. Редактирование сообщения:

```
В среднем редактируется около 10% сообщений
   
RPS: 174*10^3 * 0,1 = 17,4 тыс
```

5. Удаление сообщения:

```
В среднем удаляется около 1% сообщений
   
RPS: 174*10^3 * 0,01 = 1,74 тыс
```

6. Просмотр сообщений:

```
Каждый пользователь в среднем просматривает около 100 сообщений в день.
   
RPS: 53,6*10^6 * 100 / (24 * 60 * 60) = 62 тыс
```

7. Формирование ленты:

```
Примем, что среднее количество друзей в ВК = 100 человек
   
Каждый человек в среднем выкладывает 1 пост раз в 2 недели.
Следовательно, у человека появляется 100 постов за 2 недели или 7,1 поста в день.
Тогда у всей ежедневной аудитории 53,6*10^6 * 7,1 поста = 380,56 млн постов.
   
RPS: 380,56*10^6 / (24 * 60 * 60) = 4,4 тыс
```

#### Сводная таблица RPS по типовым действиям

| Действие                 | Тип    | RPS      |
|--------------------------|--------|----------|
| Регистрация              | Запись | 0,8      |
| Авторизация              | Запись | 6,8      |
| Создание сообщения       | Запись | 174 тыс  |
| Редактирование сообщения | Запись | 17,4 тыс |
| Удаление сообщения       | Запись | 1,74 тыс |
| Просмотр сообщений       | Чтение | 62 тыс   |
| Формирование ленты       | Чтение | 4,4 тыс  |

### Технические метрики

1. Создание сообщения:

```
В день сообщений: 15 млрд
   
Примем, что в среднем 1 сообщение содержит 30 символов.
1 символ в Unicode кодируется 2 байтами.
   
Общий объем памяти в день под сообщения: 15*10^9 * 30 * 2 = 900 Гб/день
```

2. Формирование ленты:

```
В день постов: 380,56 млн
   
1 пост в среднем весит 5 Мб (средний вес 1 фото)
   
Общий объем памяти в день под ленту: 380,56*10^6 * 5 Мб = 1800 Тб/день
```

| Действие           | Объем памяти в день |
|--------------------|---------------------|
| Создание сообщения | 900 Гб              |
| Формирование ленты | 1800 Тб             |

---

## Источники

1. [Статистика ВКонтакте в 2023 году](https://inclient.ru/vk-stats/)
2. [Анализ доли рынка, выручки и трафика vk.com](https://www.similarweb.com/ru/website/vk.com/#traffic)
3. [Итоги четвёртого квартала 2022 года ВКонтакте](https://vk.com/press/q4-2022-results)
4. [2020 год во ВКонтакте](https://www.ixbt.com/news/2020/12/25/2020-god-vo-vkontakte-kolichestvo-soobshenij-vyroslo-na-50.html)
